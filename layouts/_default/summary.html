<article class="p-6 dark:text-white lg:flex border-b border-gray-100 dark:border-warmgray-800 last:border-0">
    <a href="{{ .Permalink }}" aria-label="Read" class="shrink-0">
        {{/* 1. 画像リソースを厳密に取得（フロントマター指定優先、なければフォルダ内の画像） */}}
        {{ $img := none }}
        {{ if .Params.image }}
            {{ $img = .Resources.GetMatch .Params.image }}
        {{ end }}
        
        {{/* フロントマターにない、または見つからない場合はフォルダ内の画像ファイルを検索 */}}
        {{ if not $img }}
            {{ $img = .Resources.GetMatch "{*.jpg,*.png,*.jpeg,*.webp}" }}
        {{ end }}

        {{ if $img }}
            {{/* 2. 画像が見つかった場合：Pixiv風縦長にリサイズ */}}
            {{ $thumb := $img.Fill "200x280 q90 center" }}
            <img class="rounded shadow-sm mx-auto w-24 h-32 lg:mx-0 mb-5 object-cover lg:mb-0 hover:opacity-90 transition-opacity" 
                 src="{{ $thumb.RelPermalink }}" 
                 alt="{{ .Title }} thumbnail" />
        {{ else }}
            {{/* 3. 画像が一切ない場合：デフォルト表示 */}}
            <div class="rounded bg-gray-100 dark:bg-warmgray-800 flex items-center justify-center w-24 h-32 mx-auto lg:mx-0 mb-5 lg:mb-0">
                <img class="w-12 h-12 opacity-20" src="{{ "/img/novel.png" | relURL }}" alt="no-image" />
            </div>
        {{ end }}
    </a>

    <div class="lg:ml-8 flex-1 min-w-0">
        <a href="{{ .Permalink }}">
            <h1 class="text-xl font-bold mb-2 hover:text-blue-500 transition-colors truncate">{{ .Title }}</h1>
        </a>

        <p class="mb-1 text-sm opacity-40 flex items-center gap-2">
            <span><i class="fas fa-pencil-alt mr-1"></i>{{ partial "wordcount.html" . }}</span>
            <span>・</span>
            <span>{{ .Date.Format "2006/01/02" }}</span>
        </p>

        {{ with .Params.tags }}
            <div id="tags" class="flex flex-wrap gap-x-3 gap-y-1 mb-2"> 
                {{ range . }}
                <span class="text-sm text-blue-500 hover:underline">
                    <a href="{{ "tags" | absURL}}/{{ . | urlize }}">#{{ . }}</a>
                </span>
                {{ end }}
            </div>
        {{ end }}

        {{ if .Description }}
        <p class="opacity-70 text-sm mt-2 line-clamp-3 leading-relaxed break-words">
            {{ .Description | plainify }}
        </p>
        {{ else }}
        <p class="opacity-30 text-xs italic mt-2">（あらすじはありません）</p>
        {{ end }}
    </div>
</article>